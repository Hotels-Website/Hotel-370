{% extends "layout.html" %}
{% block content %}
<style>
  .card{
    margin-bottom:20px;
  }
</style>

















<h1>Admin</h1>
<!--<h2>Franchises</h2> not required, can add if everything else is complete-->
<h2>Reservations</h2>
<ul>
<div class="card">
<div class="card-body">
  <h3>Today's Reservations: {{session["date_display"]}}</h3>
  <table id="table1" class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">First</th>
        <th scope="col">Last</th>
        <th scope="col">Check-in Day</th>
        <th scope="col">Check-out Day</th>
        <th scope="col">Room Number</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        
      </tr>
    </tbody>
  </table>
  <hr>
  <br>
  <br>

  <h3>Future Reservations</h3>
  <table id="table2" class="table">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">First</th>
        <th scope="col">Last</th>
        <th scope="col">Check-in Day</th>
        <th scope="col">Check-out Day</th>
        <th scope="col">Room Number</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        
      </tr>
    </tbody>
  </table>
</div>
</div>


<div class="card">
<div class="card-body">
  <h3>Add Location</h3>
  <table class="table">
        <td colspan="4">   
          <form class="form-inline">
            <!-- <div class="form-group mb-2">
              <label for="staticEmail2" class="sr-only">Price</label>
              <input type="text" readonly class="form-control-plaintext" id="staticEmail2" value="Price">
            </div> -->
            <div class="form-group mx-sm-3 mb-2">
              <label for="name" class="sr-only">New Hotel Name</label>
              <input type="text" class="form-control" id="name" placeholder="New Hotel Name">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="iloc" class="sr-only">I Coordinate</label>
              <input type="text" class="form-control" id="iloc" placeholder="I Coordinate">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="jloc" class="sr-only">J Coordinate</label>
              <input type="text" class="form-control" id="jloc" placeholder="J Coordinate">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="cs" class="sr-only">Number of Cheap Suites</label>
              <input type="text" class="form-control" id="cs" placeholder="Number of Cheap Suites">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="cr" class="sr-only">Cheap Rate</label>
              <input type="text" class="form-control" id="cr" placeholder="Cheap Rate">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="es" class="sr-only">Number of Expensive Suites</label>
              <input type="text" class="form-control" id="es" placeholder="Number of Expensive Suites">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="er" class="sr-only">Expensive Rate</label>
              <input type="text" class="form-control" id="er" placeholder="Expensive Rate">
            </div>
            <button type="submit" class="btn btn-primary mb-2" id="addLoc">Add Location</button>
          </form>
        </td>
      </tr>
    </tbody>
  </table>
</div>
</div>
</ul>

<script>
	var tableRef1 = document.getElementById('table1').getElementsByTagName('tbody')[0];
	var tableRef2 = document.getElementById('table2').getElementsByTagName('tbody')[0];

	// testing auto filling reservation tables
	// i < row count from our select statement for current reservations
	for(var i = 0; i < 4; i++)
	{
		// Insert a row in the table at the last row
		var newRow   = tableRef1.insertRow();
		
		// Insert a cell in the row at index 0
		var rowNum  = newRow.insertCell(0);
		var firstName  = newRow.insertCell(1);
		var lastName  = newRow.insertCell(2);
		var startDate  = newRow.insertCell(3);
		var endDate  = newRow.insertCell(4);
		var roomNum  = newRow.insertCell(5);

		// Append a text node to the cell
		var rowNumText  = document.createTextNode(i);
		rowNum.appendChild(rowNumText);

		// all these would be filled with values retrieved from out select statement
		var firstNameText  = document.createTextNode('John');
		firstName.appendChild(firstNameText);
		var lastNameText  = document.createTextNode('Smith');
		lastName.appendChild(lastNameText);
		var startDateText  = document.createTextNode('5/5/20');
		startDate.appendChild(startDateText);
		var endDateText  = document.createTextNode('5/21/20');
		endDate.appendChild(endDateText);
		var roomNumText  = document.createTextNode('100');
		roomNum.appendChild(roomNumText );
	}
	
	// i < row count from our select statement for future reservations
	for(var i = 0; i < 4; i++)
	{
		// Insert a row in the table at the last row
		var newRow   = tableRef2.insertRow();
		
		// Insert a cell in the row at index 0
		var rowNum  = newRow.insertCell(0);
		var firstName  = newRow.insertCell(1);
		var lastName  = newRow.insertCell(2);
		var startDate  = newRow.insertCell(3);
		var endDate  = newRow.insertCell(4);
		var roomNum  = newRow.insertCell(5);

		// Append a text node to the cell
		var rowNumText  = document.createTextNode(i);
		rowNum.appendChild(rowNumText);

		// all these would be filled with values retrieved from out select statement
		var firstNameText  = document.createTextNode('John');
		firstName.appendChild(firstNameText);
		var lastNameText  = document.createTextNode('Smith');
		lastName.appendChild(lastNameText);
		var startDateText  = document.createTextNode('5/5/20');
		startDate.appendChild(startDateText);
		var endDateText  = document.createTextNode('5/21/20');
		endDate.appendChild(endDateText);
		var roomNumText  = document.createTextNode('100');
		roomNum.appendChild(roomNumText );
	}
   	addLoc.onclick = function()
    {
   	 	// checks all fields are filled
   	  	if(document.getElementById("iloc").value.length == 0||document.getElementById("jloc").value.length == 0||document.getElementById("name").value.length == 0
   	  		||document.getElementById("cs").value.length == 0||document.getElementById("cr").value.length == 0||document.getElementById("es").value.length == 0
   	  		||document.getElementById("er").value.length == 0)
   	  		alert("All fields are required. Try again")

   	  	// not sure if I can directly call location_in_db
   	  	if(location_in_db(document.getElementById("iloc"),document.getElementById("jloc")))
   	  		alert("Location already in use. Please add your hotel at a different location");
   	  	else
   	  	{
   	  		//insert_new_location({{session["hotelid"]}}, document.getElementById("name"), document.getElementById("iloc"), document.getElementById("jloc"));
   	  		// room table inconsistent with project specs unsure how to go about it
   	  		// insert_new_rooms();
   	  	}
   	};

   	// to see how data is formatted
   	const Http = new XMLHttpRequest();
    const url='/getAllLocations';
    Http.open("GET", url);
    Http.send();

    Http.onreadystatechange = (e) => {
        var text = Http.responseText;
      console.log(text);
    }
</script>
{% endblock content%}
